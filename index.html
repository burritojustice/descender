<!DOCTYPE html>
<html>
 
<head>
  <title>WOF descender</title>
  <script type="text/javascript" src="FileSaver.js"></script>
  <script type="text/javascript" src="descender.js"></script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>WOF Descender Â· Mapzen</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://mapzen.com/common/styleguide/styles/styleguide.css">
</head>

<body>
<div class="container">

<h1>WOF Descender!</h1>
<hr>Enter a <a href="https://whosonfirst.mapzen.com/spelunker">Who's on First ID</a> and get a blob of GeoJSON of its descendants!</h2>


<br><br>
<!-- experiments in a UI for entering a WOF ID and level -->
<form name="wof_data">  <!--  action="start()" -->

  WOF ID:
  <input type="text" name="wof_id" value="" placeholder="85633041" id="wof_id"> 
   Descendant type: 
    <select name="wof_level" value='region' id="wof_level">
        <option value="country">country (C)</option>
        <option value="region">region (C)</option>
        <option value="county">county (CO)</option>
        <option value="localadmin">localadmin (CO)</option>
        <option value="locality">locality (C)</option>
        <option value="macroohood">macrohood (O)</option>
        <option value="neighbourhood">neighbourhood (C)</option>
        <option value="microhood">microhood (O)</option>
        <option value="postalcode">postalcode (CO)</option>
        <option value="campus">campus (CO)</option>
        <option value="venue">venue (CO)</option>
        <option value="address">address (CO)</option>
        <option value="">--less common--</option>
        <option value="planet">planet (CO)</option>
        <option value="continent">continent (C)</option>
        <option value="ocean">ocean (CO)</option>
        <option value="empire">empire </option>
        <option value="timezone">timezone (CO)</option>
        <option value="marinearea">marinearea (CO)</option>
        <option value="dependency">dependency (CO)</option>
        <option value="macroregion">macroregion (O)</option>
        <option value="metroarea">metro area (O)</option>
        <option value="borough">borough (CO)</option>
        <option value="disputed">disputed (CO)</option>
        

    </select>
  <button class="btn btn-mapzen" type="submit" id="wof_button" >DESCEND</button>
<!-- disabled="disabled" -->
</form>
<br><br>
<div id="parent_name">
<h2 id="h2_parent"><p id="p0"></h2>
</div>
<div id="descendant_name">
<p id="p1">
</div>
<br><br>

Want the GeoJSON of California's 57 counties? Enter 85688637 and choose `county`!<br>
Or Canada's 10 provinces and 3 territories?  85633041 and choose `region`!<br>
Or San Francisco's ZIP codes? 85922583 and choose `postalcode`!<br>
(While you can skip levels (a.k.a. <a href="https://github.com/whosonfirst/whosonfirst-placetypes">placetypes</a>), only the first 500 results will be returned for now.)

<script type="text/javascript">
window.addEventListener("load", function () {
    

    var qs = window.location.search;
	qs = qs.substring(1);
	
	var params = {};
	var queries = qs.split("&");
	var count = queries.length;
	
	for ( var i = 0; i < count; i++ ) {
		temp = queries[i].split('=');
		params[temp[0]] = temp[1];
	}   
	
	console.log(params);
	
	if ((params['wof_id']) && (params['wof_level'])){

        start(params['wof_id'], params['wof_level']);
        return;
	}
	
	// what would user do?
	
	
    var b = document.getElementById("wof_button");
    b.removeAttribute("disabled");
    
    b.onclick = function(){
    
        var wof_id = document.getElementById("wof_id");
        wof_id = wof_id.value;
        
        var wof_level = document.getElementById("wof_level");
        wof_level = wof_level.value;
        
        // console.log("wof id is " + wof_id);
        // console.log("wof level is " + wof_level);
        
        try {
           start(wof_id, wof_level);
        } catch (e) {
            console.log(e);
        }
        
        return false;
    };
});
</script>
</div>
</body>
</html>


